# ุฏููู ูุธุงู ุงููุตุงุฏูุฉ - Authentication Guide

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทุจูู ูุธุงู ูุตุงุฏูุฉ ูุชูุงูู ุจุงุณุชุฎุฏุงู **Supabase Auth** ูุญูุงูุฉ ุตูุญุฉ ุฅูุดุงุก ุงูุชุตุงููู ูุฅุฏุงุฑุฉ ุญุณุงุจุงุช ุงููุณุชุฎุฏูุงุช.

## โ ุงูููุฒุงุช ุงููุทุจูุฉ

### 1. ูุธุงู ุงููุตุงุฏูุฉ ุงููุงูู
- โ ุชุณุฌูู ุญุณุงุจ ุฌุฏูุฏ (Sign Up)
- โ ุชุณุฌูู ุงูุฏุฎูู (Login)
- โ ุชุณุฌูู ุงูุฎุฑูุฌ (Logout)
- โ ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ (Password Reset)
- โ ุญูุงูุฉ ุงูุตูุญุงุช (Protected Routes)
- โ ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช (Session Management)

### 2. ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุฌุฏูู ุงููููุงุช ุงูุดุฎุตูุฉ (profiles)
- โ ุฌุฏูู ุงูุชุตุงููู ุงููุญููุธุฉ (designs)
- โ ุณูุงุณุงุช ุงูุฃูุงู (Row Level Security)
- โ Triggers ุชููุงุฆูุฉ

### 3. ูุงุฌูุฉ ุงููุณุชุฎุฏู
- โ ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
- โ ุตูุญุฉ ุงูุชุณุฌูู
- โ ุตูุญุฉ ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ
- โ ุฃุฒุฑุงุฑ ุงููุตุงุฏูุฉ ูู Header
- โ ุฏุนู ุงููุบุชูู ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ
- โ ุชุตููู ูุชุฌุงูุจ (Responsive)

## ๐๏ธ ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงูุฎุทูุฉ 1: ุงููุตูู ุฅูู Supabase SQL Editor

1. ุงูุชุญู ูุชุตูุญ ุงูููุจ ูุงุฐูุจู ุฅูู: https://supabase.com/dashboard
2. ุณุฌูู ุฏุฎููู ุฅูู ุญุณุงุจู
3. ุงุฎุชุงุฑู ุงููุดุฑูุน: `ugszpeinlqlxhejplqdh`
4. ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉุ ุงุฎุชุงุฑู **SQL Editor**

### ุงูุฎุทูุฉ 2: ุชูููุฐ ุฃููุงุฏ SQL

1. ุงูุณุฎู ูุญุชูู ููู `supabase-schema.sql` ุจุงููุงูู
2. ุงูุตููู ูู SQL Editor
3. ุงุถุบุทู ุนูู ุฒุฑ **Run** ุฃู ุงุถุบุทู `Ctrl+Enter`
4. ุงูุชุธุฑู ุญุชู ุชุธูุฑ ุฑุณุงูุฉ "Success"

### ูุง ุงูุฐู ุณูุชู ุฅูุดุงุคูุ

#### 1. ุฌุฏูู ุงููููุงุช ุงูุดุฎุตูุฉ (profiles)
```sql
- id: ูุนุฑู ุงููุณุชุฎุฏูุฉ (UUID)
- email: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- full_name: ุงูุงุณู ุงููุงูู
- avatar_url: ุฑุงุจุท ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ
- created_at: ุชุงุฑูุฎ ุงูุฅูุดุงุก
- updated_at: ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ
```

#### 2. ุฌุฏูู ุงูุชุตุงููู (designs)
```sql
- id: ูุนุฑู ุงูุชุตููู (UUID)
- user_id: ูุนุฑู ุงููุณุชุฎุฏูุฉ
- title: ุนููุงู ุงูุชุตููู
- original_description: ุงููุตู ุงูุฃุตูู
- enhanced_prompt: ุงูุจุฑููุจุช ุงููุญุณูู
- image_url: ุฑุงุจุท ุงูุตูุฑุฉ
- image_data: ุจูุงูุงุช ุงูุตูุฑุฉ (Base64)
- questionnaire_answers: ุฅุฌุงุจุงุช ุงูุงุณุชุจูุงู (JSON)
- is_favorite: ููุถูุ
- created_at: ุชุงุฑูุฎ ุงูุฅูุดุงุก
- updated_at: ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ
```

#### 3. ุณูุงุณุงุช ุงูุฃูุงู (RLS Policies)
- ุงููุณุชุฎุฏูุงุช ูููููู ููุท ุฑุคูุฉ ูุชุนุฏูู ุจูุงูุงุชูู ุงูุฎุงุตุฉ
- ุญูุงูุฉ ูุงููุฉ ููุจูุงูุงุช ุนูู ูุณุชูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### 4. Triggers ุงูุชููุงุฆูุฉ
- ุฅูุดุงุก ููู ุดุฎุตู ุชููุงุฆูุงู ุนูุฏ ุงูุชุณุฌูู
- ุชุญุฏูุซ `updated_at` ุชููุงุฆูุงู ุนูุฏ ุงูุชุนุฏูู

## ๐ ูุชุบูุฑุงุช ุงูุจูุฆุฉ

ุชู ุฅุถุงูุฉ ูุชุบูุฑุงุช Supabase ุฅูู ููู `.env.local`:

```env
# Supabase Configuration
NEXT_PUBLIC_SUPABASE_URL=https://ugszpeinlqlxhejplqdh.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

## ๐ ุงูุจููุฉ ุงูุฌุฏูุฏุฉ ูููุดุฑูุน

```
ai-dress-designer/
โโโ app/
โ   โโโ auth/
โ   โ   โโโ login/
โ   โ   โ   โโโ page.tsx          # ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
โ   โ   โโโ signup/
โ   โ   โ   โโโ page.tsx          # ุตูุญุฉ ุงูุชุณุฌูู
โ   โ   โโโ reset-password/
โ   โ       โโโ page.tsx          # ุตูุญุฉ ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ
โ   โโโ design/
โ       โโโ page.tsx              # ุตูุญุฉ ูุญููุฉ - ุชุชุทูุจ ุชุณุฌูู ุฏุฎูู
โโโ lib/
โ   โโโ supabase/
โ       โโโ client.ts             # Supabase client ูููุชุตูุญ
โ       โโโ server.ts             # Supabase client ููุณูุฑูุฑ
โ       โโโ middleware.ts         # Middleware ูููุตุงุฏูุฉ
โโโ middleware.ts                 # Next.js middleware
โโโ supabase-schema.sql          # ุฃููุงุฏ SQL ููุงุนุฏุฉ ุงูุจูุงูุงุช
โโโ AUTHENTICATION_GUIDE.md      # ูุฐุง ุงูููู
```

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูููุณุชุฎุฏูุงุช

#### 1. ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ
1. ุงุฐูุจู ุฅูู: http://localhost:3000/auth/signup
2. ุฃุฏุฎูู:
   - ุงูุงุณู ุงููุงูู
   - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
   - ูููุฉ ุงููุฑูุฑ (8 ุฃุญุฑู ุนูู ุงูุฃูู)
   - ุชุฃููุฏ ูููุฉ ุงููุฑูุฑ
3. ูุงููู ุนูู ุงูุดุฑูุท ูุงูุฃุญูุงู
4. ุงุถุบุทู "ุฅูุดุงุก ุญุณุงุจ"
5. ุชุญููู ูู ุจุฑูุฏู ุงูุฅููุชุฑููู ูุชูุนูู ุงูุญุณุงุจ

#### 2. ุชุณุฌูู ุงูุฏุฎูู
1. ุงุฐูุจู ุฅูู: http://localhost:3000/auth/login
2. ุฃุฏุฎูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููููุฉ ุงููุฑูุฑ
3. ุงุถุบุทู "ุชุณุฌูู ุงูุฏุฎูู"
4. ุณูุชู ุชูุฌููู ุชููุงุฆูุงู ุฅูู ุตูุญุฉ ุงูุชุตููู

#### 3. ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ
1. ูู ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎููุ ุงุถุบุทู "ูุณูุชู ูููุฉ ุงููุฑูุฑุ"
2. ุฃุฏุฎูู ุจุฑูุฏู ุงูุฅููุชุฑููู
3. ุงุถุบุทู "ุฅุฑุณุงู ุฑุงุจุท ุงูุงุณุชุนุงุฏุฉ"
4. ุชุญููู ูู ุจุฑูุฏู ุงูุฅููุชุฑููู

### ุญูุงูุฉ ุงูุตูุญุงุช

ุตูุญุฉ `/design` ูุญููุฉ ุชููุงุฆูุงู:
- ุฅุฐุง ูู ุชูููู ูุณุฌูุฉ ุฏุฎููุ ุณูุชู ุชูุฌููู ุฅูู ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
- ุจุนุฏ ุชุณุฌูู ุงูุฏุฎููุ ุณูุชู ุชูุฌููู ูุฑุฉ ุฃุฎุฑู ุฅูู ุงูุตูุญุฉ ุงููุทููุจุฉ

## ๐จ ุงูุชุฑุฌูุงุช

ุชู ุฅุถุงูุฉ ุชุฑุฌูุงุช ูุงููุฉ ููุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ ูู:
- `public/locales/ar.json`
- `public/locales/en.json`

ุฌููุน ุงููุตูุต ุชุณุชุฎุฏู ุตูุบุฉ ุงููุคูุซ ูู ุงูุนุฑุจูุฉ ููุง ูู ูุทููุจ.

## ๐ง ูููุทูุฑูู

### ุงุณุชุฎุฏุงู Supabase Client

#### ูู ุงูููููุงุช (Client Components)
```typescript
import { createClient } from '@/lib/supabase/client';

const supabase = createClient();
const { data: { user } } = await supabase.auth.getUser();
```

#### ูู Server Components
```typescript
import { createClient } from '@/lib/supabase/server';

const supabase = await createClient();
const { data: { user } } = await supabase.auth.getUser();
```

### ุญูุธ ุงูุชุตุงููู

```typescript
const supabase = createClient();
const { data, error } = await supabase
  .from('designs')
  .insert({
    user_id: user.id,
    title: 'ูุณุชุงู ุณูุฑุฉ',
    original_description: '...',
    enhanced_prompt: '...',
    image_data: '...',
  });
```

### ุฌูุจ ุงูุชุตุงููู ุงููุญููุธุฉ

```typescript
const { data: designs, error } = await supabase
  .from('designs')
  .select('*')
  .eq('user_id', user.id)
  .order('created_at', { ascending: false });
```

## โจ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑู)

ููููู ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงูููุฒุงุช:

1. **ุตูุญุฉ ุงูููู ุงูุดุฎุตู**
   - ุชุนุฏูู ุงูุงุณู ูุงูุตูุฑุฉ ุงูุดุฎุตูุฉ
   - ุชุบููุฑ ูููุฉ ุงููุฑูุฑ

2. **ุตูุญุฉ ุงูุชุตุงููู ุงููุญููุธุฉ**
   - ุนุฑุถ ุฌููุน ุงูุชุตุงููู ุงูุณุงุจูุฉ
   - ุญุฐู ูุชุนุฏูู ุงูุชุตุงููู
   - ุชุตููู ุงูุชุตุงููู ุงูููุถูุฉ

3. **ูุดุงุฑูุฉ ุงูุชุตุงููู**
   - ุฅูุดุงุก ุฑูุงุจุท ูุดุงุฑูุฉ
   - ุชุตุฏูุฑ ุงูุชุตุงููู

4. **ุชุณุฌูู ุงูุฏุฎูู ุจุฌูุฌู**
   - ุชูุนูู Google OAuth ูู Supabase
   - ุฅุถุงูุฉ ูุธููุฉ ุชุณุฌูู ุงูุฏุฎูู ุจุฌูุฌู

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ูููู ุชุณุฌูู ุงูุฏุฎูู
- ุชุฃูุฏู ูู ุชูุนูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- ุชุญููู ูู ุตุญุฉ ูููุฉ ุงููุฑูุฑ

### ุงููุดููุฉ: ุฎุทุฃ ูู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุฃูุฏู ูู ุชูููุฐ ุฃููุงุฏ SQL ูู Supabase
- ุชุญููู ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ ูู `.env.local`

### ุงููุดููุฉ: ูุง ูุชู ุฅูุดุงุก ุงูููู ุงูุดุฎุตู ุชููุงุฆูุงู
- ุชุฃูุฏู ูู ุชูููุฐ Trigger `on_auth_user_created`
- ุชุญููู ูู ุฌุฏูู `profiles` ูู Supabase

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุชู ุฃู ูุดุงูู:
1. ุชุญููู ูู console ุงููุชุตูุญ ููุฃุฎุทุงุก
2. ุชุญููู ูู Supabase Dashboard > Logs
3. ุฑุงุฌุนู ูุฐุง ุงูุฏููู ูุฑุฉ ุฃุฎุฑู

---

**ุชู ุจูุฌุงุญ! ๐**

ูุธุงู ุงููุตุงุฏูุฉ ุฌุงูุฒ ููุงุณุชุฎุฏุงู. ููููู ุงูุขู ุงูุจุฏุก ูู ุงุฎุชุจุงุฑ ุงูุชุทุจูู.

